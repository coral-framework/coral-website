<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta content="width=device-width, initial-scale=1.0" name=viewport><title>co.IDynamicServiceProvider | Coral · Reference · Modules · Coral (co)</title><link href="../../../../assets/stylesheets/style.css" media=screen rel=stylesheet /></meta></meta></head><body class="reference reference_modules reference_modules_co reference_modules_co_IDynamicServiceProvider reference_modules_co_IDynamicServiceProvider_index"><header class="navbar navbar-default navbar-fixed-top" role=navigation><div class=container><div class=navbar-header><button class=navbar-toggle data-target=".navbar-collapse" data-toggle=collapse type=button><span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button><a class=brand href="/"><img class=brand src="../../../../assets/images/coral-logo.svg"/></a></div><nav class="collapse navbar-collapse" role=navigation><ul class="nav navbar-nav"><li><a href="/guides/getting-started"><i class=icon-enter></i> Get Started</a></li><li><a href="/guides"><i class=icon-book></i> Guides</a></li><li class=active><a href="/reference"><i class=icon-gears></i> Reference</a></li><li><a href="/community"><i class=icon-users></i> Community</a></li></ul><div class=navbar-right id=search-widget><i class=icon-search></i><input class="form-control searchbox" placeholder="Search the API and Pages — press 's'"/></div></nav></div></header><div class=container><div class=row><div class="col-md-3 hidden-print" role=complementary><div class=sidebar><div class=api id=toc><ul class="nav level-1"><li><a href="#_top">co.IDynamicServiceProvider</a></li><ul class="nav level-2"><li><a href="#_hierarchy"><i class=icon-hierarchy></i> Hierarchy</a></li><li><a href="#_methods"><i class=icon-method></i> Methods</a><ul class="nav level-3"><li><a class=mono href="#dynamicGetFacet">dynamicGetFacet</a></li><li><a class=mono href="#dynamicGetField">dynamicGetField</a></li><li><a class=mono href="#dynamicInvoke">dynamicInvoke</a></li><li><a class=mono href="#dynamicRegisterService">dynamicRegisterService</a></li><li><a class=mono href="#dynamicSetField">dynamicSetField</a></li></ul></li></ul></ul></div></div></div><div class=col-md-9 role=main><a id=_top></a><ol class=breadcrumb><li><a href="/"> Coral</a></li><li><a href="/reference">Reference</a></li><li><a href="/reference/modules">Modules</a></li><li><a href="/reference/modules/co">Coral Module</a></li><li class=active>co.IDynamicServiceProvider</li></ol><div class=page-header><h1>co.IDynamicServiceProvider<small>interface</small></h1></div><div class=doc><p class=lead>Allows an object to provide new services at runtime via <em>dynamic proxies</em>.</p> <div class=hl><p><strong>This interface can only be implemented in C++.</strong></p> <p>A <em>dynamic proxy</em> is a service that uses reflection to delegate calls to a <a href="/reference/modules/co/IDynamicServiceProvider" class=nc>co.IDynamicServiceProvider</a>. The provider handles all field and method calls for its proxies via <a href="#dynamicGetField" class=nf>dynamicGetField</a>, <a href="#dynamicSetField" class=nf>dynamicSetField</a> and <a href="#dynamicInvoke" class=nf>dynamicInvoke</a>.</p> <p>A proxy is created by calling <a href="/reference/modules/co/IReflector#newDynamicProxy" class=nf>newDynamicProxy</a> on an interface reflector. For example, in order to provide a service of type <code>bar.IFoo</code> at runtime, an object may create a proxy for itself like this:</p> <div class="hl code"><pre class=cpp>
<span class="n">co</span><span class="o">::</span><span class="n">getType</span><span class="p">(</span> <span class="s">&quot;bar.IFoo&quot;</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">getReflector</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">newDynamicProxy</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span></pre></div> <p>The created proxy will call <a href="#dynamicRegisterService" class=nf>dynamicRegisterService</a> from its constructor. In this call the <em>provider</em> must save a pointer to the proxy—which it must <em>delete</em> at some point—and assign an <em>id &gt;= 0</em> to identify the proxy in all future calls.</p> <p>Currently the only safe place to <em>delete</em> a proxy is in the provider’s destructor. <strong>Per-proxy reference counting is not currently supported, but this will be fixed in the next release.</strong></p> </div></div><ul class=meta><li><i class="fa fa-fw fa-tags"></i><strong>Tags:</strong><ul class=tag-list><li><a href="/reference/modules/co#component-model">Component Model</a></li></ul></li><li><i class="fa fa-fw fa-link"></i><strong>Referenced from 2 types</strong>: <a href="/reference/modules/co/IReflector" class=nc>co.IReflector</a>, <a href="/reference/modules/lua/Component" class=nc>lua.Component</a>.</li></ul><h2 id=_hierarchy><i class=icon-hierarchy></i> Hierarchy</h2><div class=hierarchy><ul><li><span><a href="/reference/modules/co/IService" class=nc>co.IService</a></span>Base of all interfaces. Represents a service provided by an object. <ul><li><span><strong>co.IDynamicServiceProvider</strong></span>Allows an object to provide new services at runtime via dynamic proxies. </li></ul></li></ul></div><h2 id=_methods><i class=icon-method></i> Methods</h2><div class=member-list><div class="member hl collapsible" id=dynamicGetFacet><div class=proto data-target="#dynamicGetFacet_rest" data-toggle=collapse><p><a href="/reference/modules/co/IPort" class=nc>co.IPort</a> <span class="heading nf">dynamicGetFacet</span><span class=paren>(</span><span class=k>in</span>&nbsp;<span class=k>int32</span>&nbsp;<span class=nl>proxyId</span><span class=paren>)</span></p></div><div class=doc><p class=lead>Called when the port through which a proxy is provided is requested.</p> <div class="collapse in" id=dynamicGetFacet_rest><p><strong>Currently this means a new component type must be defined for every dynamic object layout, which is very limiting. In the next release we will allow for every single object to have a unique set of ports.</strong></p> </div></div></div><div class="member hl collapsible" id=dynamicGetField><div class=proto data-target="#dynamicGetField_rest" data-toggle=collapse><p><span class=k>void</span> <span class="heading nf">dynamicGetField</span><span class=paren>(</span><span class=k>in</span>&nbsp;<span class=k>int32</span>&nbsp;<span class=nl>proxyId</span>, <span class=k>in</span>&nbsp;<a href="/reference/modules/co/IField" class=nc>co.IField</a>&nbsp;<span class=nl>field</span>, <span class=k>in</span>&nbsp;<span class=k>any</span>&nbsp;<span class=nl>var</span><span class=paren>)</span></p></div><div class=doc><p class=lead>Called when a proxy needs to get the value of a <code>field</code>.</p> <div class="collapse in" id=dynamicGetField_rest><p>This method should put the field’s value into <code>var</code>.</p> </div></div></div><div class="member hl collapsible" id=dynamicInvoke><div class=proto data-target="#dynamicInvoke_rest" data-toggle=collapse><p><span class=k>void</span> <span class="heading nf">dynamicInvoke</span><span class=paren>(</span><span class=k>in</span>&nbsp;<span class=k>int32</span>&nbsp;<span class=nl>proxyId</span>, <span class=k>in</span>&nbsp;<a href="/reference/modules/co/IMethod" class=nc>co.IMethod</a>&nbsp;<span class=nl>method</span>, <span class=k>in</span>&nbsp;<span class=k>any</span><span class=o>[]</span>&nbsp;<span class=nl>args</span>, <span class=k>in</span>&nbsp;<span class=k>any</span>&nbsp;<span class=nl>retVal</span><span class=paren>)</span></p></div><div class=doc><p class=lead>Called when a proxy has a <code>method</code> invoked.</p> <div class="collapse in" id=dynamicInvoke_rest><p>Arguments in <code>args</code> are in direct order and honor <em>out</em> variables.</p> <p>This method must obey the invoked method’s contract. It should put the method’s return value (if any) into <code>retVal</code> and any additional output values into the corresponding variables in <code>args</code>.</p> </div></div></div><div class="member hl collapsible" id=dynamicRegisterService><div class=proto data-target="#dynamicRegisterService_rest" data-toggle=collapse><p><span class=k>int32</span> <span class="heading nf">dynamicRegisterService</span><span class=paren>(</span><span class=k>in</span>&nbsp;<a href="/reference/modules/co/IService" class=nc>co.IService</a>&nbsp;<span class=nl>proxy</span><span class=paren>)</span></p></div><div class=doc><p class=lead>Called when a new <code>proxy</code> service is created for this provider.</p> <div class="collapse in" id=dynamicRegisterService_rest><p>This method is called from within the constructor of a proxy created for this provider. It must save a raw pointer to the proxy and return an <em>id &gt;= 0</em> to identify the proxy in all future calls.</p> </div></div></div><div class="member hl collapsible" id=dynamicSetField><div class=proto data-target="#dynamicSetField_rest" data-toggle=collapse><p><span class=k>void</span> <span class="heading nf">dynamicSetField</span><span class=paren>(</span><span class=k>in</span>&nbsp;<span class=k>int32</span>&nbsp;<span class=nl>proxyId</span>, <span class=k>in</span>&nbsp;<a href="/reference/modules/co/IField" class=nc>co.IField</a>&nbsp;<span class=nl>field</span>, <span class=k>in</span>&nbsp;<span class=k>any</span>&nbsp;<span class=nl>value</span><span class=paren>)</span></p></div><div class=doc><p class=lead>Called when a proxy needs to set the value of a <code>field</code>.</p> <div class="collapse in" id=dynamicSetField_rest><p>This method should set the field’s value to <code>value</code>.</p> </div></div></div></div></div></div></div><footer class=footer><div class=container><p>Code licensed under the<a href="https://raw.github.com/coral-framework/coral/master/LICENSE" target=_blank> MIT License</a>. Documentation licensed under<a href="//creativecommons.org/licenses/by-sa/4.0/" target=_blank> CC BY-SA</a>.</p><ul class=list-inline><li>Currently v0.8.0</li><li>·</li><li><a href="/about"> About</a></li><li>·</li><li><a href="https://github.com/coral-framework/coral"> GitHub</a></li><li>·</li><li><a href="https://github.com/coral-framework/coral/issues"> Issues</a></li><li>·</li><li><a href="https://github.com/coral-framework/coral/releases"> Releases</a></li></ul></div></footer><script src="//code.jquery.com/jquery-2.1.0.min.js"></script><script src="../../../../assets/javascripts/script.js"></script></body></html>